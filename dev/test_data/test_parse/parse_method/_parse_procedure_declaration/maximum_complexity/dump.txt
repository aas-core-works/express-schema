ProcedureDeclaration(
  position=1:1,
  identifier='comprehensiveDataProcessor',
  formal_parameters=[
      FormalParameter(
        position=2:9,
        identifiers=['inputStreams'],
        of_type=ConformantArrayType(
            position=2:24,
            bound_spec=BoundSpec(
                position=2:30,
                lower=IntegerLiteral(
                    position=2:31,
                    value=1
                  ),
                upper=IntegerLiteral(
                    position=2:33,
                    value=5
                  )
              ),
            optional=False,
            unique=False,
            of=ConformantListType(
                position=2:39,
                bound_spec=BoundSpec(
                    position=2:44,
                    lower=IntegerLiteral(
                        position=2:45,
                        value=1
                      ),
                    upper=IndeterminateLiteral(
                        position=2:47
                      )
                  ),
                unique=False,
                of=NamedType(
                    position=2:53,
                    reference='DataRecord'
                  )
              )
          )
      ),
      FormalParameter(
        position=3:9,
        identifiers=['processingRules'],
        of_type=ConformantSetType(
            position=3:27,
            bound_spec=BoundSpec(
                position=3:31,
                lower=IntegerLiteral(
                    position=3:32,
                    value=1
                  ),
                upper=IntegerLiteral(
                    position=3:34,
                    value=20
                  )
              ),
            of=NamedType(
                position=3:41,
                reference='ProcessingRule'
              )
          )
      ),
      FormalParameter(
        position=4:9,
        identifiers=['qualityThresholds'],
        of_type=ConformantBagType(
            position=4:29,
            bound_spec=BoundSpec(
                position=4:33,
                lower=IntegerLiteral(
                    position=4:34,
                    value=0
                  ),
                upper=IntegerLiteral(
                    position=4:36,
                    value=10
                  )
              ),
            of=NamedType(
                position=4:43,
                reference='QualityThreshold'
              )
          )
      ),
      FormalParameter(
        position=5:13,
        identifiers=['outputStreams'],
        of_type=ConformantArrayType(
            position=5:29,
            bound_spec=BoundSpec(
                position=5:35,
                lower=IntegerLiteral(
                    position=5:36,
                    value=1
                  ),
                upper=IntegerLiteral(
                    position=5:38,
                    value=5
                  )
              ),
            optional=False,
            unique=False,
            of=ConformantListType(
                position=5:44,
                bound_spec=BoundSpec(
                    position=5:49,
                    lower=IntegerLiteral(
                        position=5:50,
                        value=1
                      ),
                    upper=IndeterminateLiteral(
                        position=5:52
                      )
                  ),
                unique=False,
                of=NamedType(
                    position=5:58,
                    reference='ProcessedRecord'
                  )
              )
          )
      ),
      FormalParameter(
        position=6:13,
        identifiers=['qualityReports'],
        of_type=ConformantArrayType(
            position=6:30,
            bound_spec=BoundSpec(
                position=6:36,
                lower=IntegerLiteral(
                    position=6:37,
                    value=1
                  ),
                upper=IntegerLiteral(
                    position=6:39,
                    value=5
                  )
              ),
            optional=False,
            unique=False,
            of=NamedType(
                position=6:45,
                reference='QualityReport'
              )
          )
      ),
      FormalParameter(
        position=7:13,
        identifiers=['globalMetrics'],
        of_type=NamedType(
            position=7:29,
            reference='GlobalProcessingMetrics'
          )
      ),
      FormalParameter(
        position=8:13,
        identifiers=['errorLogs'],
        of_type=ConformantArrayType(
            position=8:25,
            bound_spec=BoundSpec(
                position=8:31,
                lower=IntegerLiteral(
                    position=8:32,
                    value=1
                  ),
                upper=IntegerLiteral(
                    position=8:34,
                    value=100
                  )
              ),
            optional=False,
            unique=False,
            of=NamedType(
                position=8:42,
                reference='ErrorRecord'
              )
          )
      )
    ],
  head=AlgorithmHead(
      declarations=[
          TypeDeclaration(
            position=11:5,
            identifier='ProcessingPhase',
            type_selection=EnumType(
                position=11:28,
                values=[
                    'preprocessing',
                    'validation',
                    'transformation',
                    'postprocessing',
                    'finalization'
                  ]
              ),
            domain_rules=[]
          ),
          TypeDeclaration(
            position=15:5,
            identifier='QualityLevel',
            type_selection=EnumType(
                position=15:25,
                values=[
                    'unacceptable',
                    'poor',
                    'acceptable',
                    'good',
                    'excellent'
                  ]
              ),
            domain_rules=[]
          ),
          EntityDeclaration(
            position=19:5,
            identifier='ProcessingContext',
            explicit_clauses=[
                ExplicitAttributeDefinition(
                  position=20:9,
                  attributes=[NameRef(
                      position=20:9,
                      identifier='currentPhase'
                    )],
                  optional=False,
                  type_selection=NamedType(
                      position=20:24,
                      reference='ProcessingPhase'
                    )
                ),
                ExplicitAttributeDefinition(
                  position=21:9,
                  attributes=[NameRef(
                      position=21:9,
                      identifier='streamIndex'
                    )],
                  optional=False,
                  type_selection=IntegerType(
                      position=21:23
                    )
                ),
                ExplicitAttributeDefinition(
                  position=22:9,
                  attributes=[NameRef(
                      position=22:9,
                      identifier='recordIndex'
                    )],
                  optional=False,
                  type_selection=IntegerType(
                      position=22:23
                    )
                ),
                ExplicitAttributeDefinition(
                  position=23:9,
                  attributes=[NameRef(
                      position=23:9,
                      identifier='qualityLevel'
                    )],
                  optional=False,
                  type_selection=NamedType(
                      position=23:24,
                      reference='QualityLevel'
                    )
                ),
                ExplicitAttributeDefinition(
                  position=24:9,
                  attributes=[NameRef(
                      position=24:9,
                      identifier='errorCount'
                    )],
                  optional=False,
                  type_selection=IntegerType(
                      position=24:22
                    )
                )
              ],
            derive_clauses=[],
            inverse_clauses=[],
            unique_rules=[],
            domain_rules=[]
          ),
          FunctionDeclaration(
            position=27:5,
            identifier='evaluateQuality',
            formal_parameters=[
                FormalParameter(
                  position=27:30,
                  identifiers=['record'],
                  of_type=NamedType(
                      position=27:39,
                      reference='ProcessedRecord'
                    )
                ),
                FormalParameter(
                  position=27:56,
                  identifiers=['thresholds'],
                  of_type=NamedType(
                      position=27:69,
                      reference='QualityThreshold'
                    )
                )
              ],
            return_type=NamedType(
                position=27:89,
                reference='QualityLevel'
              ),
            head=AlgorithmHead(
                declarations=[],
                constant_definitions=[],
                local_variable_definitions=[]
              ),
            body=[ReturnStmt(
                position=28:9,
                value=NameRef(
                    position=28:16,
                    identifier='acceptable'
                  )
              )]
          ),
          ProcedureDeclaration(
            position=31:5,
            identifier='logError',
            formal_parameters=[
                FormalParameter(
                  position=31:24,
                  identifiers=['context'],
                  of_type=NamedType(
                      position=31:34,
                      reference='ProcessingContext'
                    )
                ),
                FormalParameter(
                  position=31:53,
                  identifiers=['message'],
                  of_type=StringType(
                      position=31:63,
                      fixed=False
                    )
                ),
                FormalParameter(
                  position=31:75,
                  identifiers=['errorLog'],
                  of_type=NamedType(
                      position=31:86,
                      reference='ErrorRecord'
                    )
                )
              ],
            head=AlgorithmHead(
                declarations=[],
                constant_definitions=[],
                local_variable_definitions=[]
              ),
            body=[
                AssignmentStmt(
                  position=32:9,
                  target=AttributeRef(
                      position=32:9,
                      source=NameRef(
                          position=32:9,
                          identifier='errorLog'
                        ),
                      identifier='phase'
                    ),
                  value=AttributeRef(
                      position=32:27,
                      source=NameRef(
                          position=32:27,
                          identifier='context'
                        ),
                      identifier='currentPhase'
                    )
                ),
                AssignmentStmt(
                  position=33:9,
                  target=AttributeRef(
                      position=33:9,
                      source=NameRef(
                          position=33:9,
                          identifier='errorLog'
                        ),
                      identifier='streamIndex'
                    ),
                  value=AttributeRef(
                      position=33:33,
                      source=NameRef(
                          position=33:33,
                          identifier='context'
                        ),
                      identifier='streamIndex'
                    )
                ),
                AssignmentStmt(
                  position=34:9,
                  target=AttributeRef(
                      position=34:9,
                      source=NameRef(
                          position=34:9,
                          identifier='errorLog'
                        ),
                      identifier='recordIndex'
                    ),
                  value=AttributeRef(
                      position=34:33,
                      source=NameRef(
                          position=34:33,
                          identifier='context'
                        ),
                      identifier='recordIndex'
                    )
                ),
                AssignmentStmt(
                  position=35:9,
                  target=AttributeRef(
                      position=35:9,
                      source=NameRef(
                          position=35:9,
                          identifier='errorLog'
                        ),
                      identifier='message'
                    ),
                  value=NameRef(
                      position=35:29,
                      identifier='message'
                    )
                ),
                AssignmentStmt(
                  position=36:9,
                  target=AttributeRef(
                      position=36:9,
                      source=NameRef(
                          position=36:9,
                          identifier='errorLog'
                        ),
                      identifier='timestamp'
                    ),
                  value=Call(
                      position=36:31,
                      callee=NameRef(
                          position=36:31,
                          identifier='getCurrentTime'
                        ),
                      args=[]
                    )
                )
              ]
          ),
          ProcedureDeclaration(
            position=39:5,
            identifier='updateMetrics',
            formal_parameters=[
                FormalParameter(
                  position=39:29,
                  identifiers=['context'],
                  of_type=NamedType(
                      position=39:39,
                      reference='ProcessingContext'
                    )
                ),
                FormalParameter(
                  position=39:62,
                  identifiers=['metrics'],
                  of_type=NamedType(
                      position=39:72,
                      reference='GlobalProcessingMetrics'
                    )
                )
              ],
            head=AlgorithmHead(
                declarations=[],
                constant_definitions=[],
                local_variable_definitions=[]
              ),
            body=[
                AssignmentStmt(
                  position=40:9,
                  target=AttributeRef(
                      position=40:9,
                      source=NameRef(
                          position=40:9,
                          identifier='metrics'
                        ),
                      identifier='totalRecordsProcessed'
                    ),
                  value=BinaryExpr(
                      position=40:42,
                      left=AttributeRef(
                          position=40:42,
                          source=NameRef(
                              position=40:42,
                              identifier='metrics'
                            ),
                          identifier='totalRecordsProcessed'
                        ),
                      op=BinaryOp.ADD,
                      right=IntegerLiteral(
                          position=40:74,
                          value=1
                        )
                    )
                ),
                IfStmt(
                  position=41:9,
                  condition=BinaryExpr(
                      position=41:12,
                      left=AttributeRef(
                          position=41:12,
                          source=NameRef(
                              position=41:12,
                              identifier='context'
                            ),
                          identifier='errorCount'
                        ),
                      op=BinaryOp.GREATER_THAN,
                      right=IntegerLiteral(
                          position=41:33,
                          value=0
                        )
                    ),
                  then=[AssignmentStmt(
                      position=42:13,
                      target=AttributeRef(
                          position=42:13,
                          source=NameRef(
                              position=42:13,
                              identifier='metrics'
                            ),
                          identifier='totalErrors'
                        ),
                      value=BinaryExpr(
                          position=42:36,
                          left=AttributeRef(
                              position=42:36,
                              source=NameRef(
                                  position=42:36,
                                  identifier='metrics'
                                ),
                              identifier='totalErrors'
                            ),
                          op=BinaryOp.ADD,
                          right=AttributeRef(
                              position=42:58,
                              source=NameRef(
                                  position=42:58,
                                  identifier='context'
                                ),
                              identifier='errorCount'
                            )
                        )
                    )],
                  or_else=[]
                )
              ]
          )
        ],
      constant_definitions=[
          ConstantDefinition(
            position=47:9,
            identifier='maxErrorsPerStream',
            type_selection=IntegerType(
                position=47:30
              ),
            init=IntegerLiteral(
                position=47:41,
                value=50
              )
          ),
          ConstantDefinition(
            position=48:9,
            identifier='defaultQualityLevel',
            type_selection=NamedType(
                position=48:31,
                reference='QualityLevel'
              ),
            init=NameRef(
                position=48:47,
                identifier='acceptable'
              )
          ),
          ConstantDefinition(
            position=49:9,
            identifier='processingTimeout',
            type_selection=RealType(
                position=49:29
              ),
            init=RealLiteral(
                position=49:37,
                value=600.0
              )
          ),
          ConstantDefinition(
            position=50:9,
            identifier='maxConcurrentStreams',
            type_selection=IntegerType(
                position=50:32
              ),
            init=IntegerLiteral(
                position=50:43,
                value=5
              )
          ),
          ConstantDefinition(
            position=51:9,
            identifier='bufferSize',
            type_selection=IntegerType(
                position=51:22
              ),
            init=IntegerLiteral(
                position=51:33,
                value=1000
              )
          )
        ],
      local_variable_definitions=[
          LocalVariableDefinition(
            position=55:9,
            identifiers=['processingContext'],
            of_type=NamedType(
                position=55:29,
                reference='ProcessingContext'
              )
          ),
          LocalVariableDefinition(
            position=56:9,
            identifiers=['currentRecord'],
            of_type=NamedType(
                position=56:25,
                reference='DataRecord'
              )
          ),
          LocalVariableDefinition(
            position=57:9,
            identifiers=['processedRecord'],
            of_type=NamedType(
                position=57:27,
                reference='ProcessedRecord'
              )
          ),
          LocalVariableDefinition(
            position=58:9,
            identifiers=['currentRule'],
            of_type=NamedType(
                position=58:23,
                reference='ProcessingRule'
              )
          ),
          LocalVariableDefinition(
            position=59:9,
            identifiers=['currentThreshold'],
            of_type=NamedType(
                position=59:28,
                reference='QualityThreshold'
              )
          ),
          LocalVariableDefinition(
            position=60:9,
            identifiers=['qualityLevel'],
            of_type=NamedType(
                position=60:24,
                reference='QualityLevel'
              )
          ),
          LocalVariableDefinition(
            position=61:9,
            identifiers=['errorRecord'],
            of_type=NamedType(
                position=61:23,
                reference='ErrorRecord'
              )
          ),
          LocalVariableDefinition(
            position=62:9,
            identifiers=[
                'streamIndex',
                'recordIndex',
                'ruleIndex',
                'thresholdIndex'
              ],
            of_type=IntegerType(
                position=62:63
              )
          ),
          LocalVariableDefinition(
            position=63:9,
            identifiers=['errorIndex'],
            of_type=IntegerType(
                position=63:22
              ),
            init=IntegerLiteral(
                position=63:33,
                value=0
              )
          ),
          LocalVariableDefinition(
            position=64:9,
            identifiers=['processingBuffer'],
            of_type=ConformantArrayType(
                position=64:28,
                bound_spec=BoundSpec(
                    position=64:34,
                    lower=IntegerLiteral(
                        position=64:35,
                        value=1
                      ),
                    upper=NameRef(
                        position=64:37,
                        identifier='bufferSize'
                      )
                  ),
                optional=False,
                unique=False,
                of=NamedType(
                    position=64:52,
                    reference='ProcessedRecord'
                  )
              ),
            init=AggregateLiteral(
                position=64:71,
                elements=[]
              )
          ),
          LocalVariableDefinition(
            position=65:9,
            identifiers=['bufferIndex'],
            of_type=IntegerType(
                position=65:23
              ),
            init=IntegerLiteral(
                position=65:34,
                value=0
              )
          ),
          LocalVariableDefinition(
            position=66:9,
            identifiers=[
                'processingStartTime',
                'processingEndTime'
              ],
            of_type=RealType(
                position=66:50
              )
          ),
          LocalVariableDefinition(
            position=67:9,
            identifiers=['streamProcessingTime'],
            of_type=RealType(
                position=67:32
              )
          ),
          LocalVariableDefinition(
            position=68:9,
            identifiers=['totalProcessingTime'],
            of_type=RealType(
                position=68:31
              ),
            init=RealLiteral(
                position=68:39,
                value=0.0
              )
          ),
          LocalVariableDefinition(
            position=69:9,
            identifiers=['isProcessingSuccessful'],
            of_type=BooleanType(
                position=69:34
              )
          ),
          LocalVariableDefinition(
            position=70:9,
            identifiers=['shouldContinueProcessing'],
            of_type=BooleanType(
                position=70:36
              ),
            init=LogicalLiteral(
                position=70:47,
                value=TRUE
              )
          )
        ]
    ),
  body=[
      AssignmentStmt(
        position=73:5,
        target=AttributeRef(
            position=73:5,
            source=NameRef(
                position=73:5,
                identifier='globalMetrics'
              ),
            identifier='totalRecordsProcessed'
          ),
        value=IntegerLiteral(
            position=73:44,
            value=0
          )
      ),
      AssignmentStmt(
        position=74:5,
        target=AttributeRef(
            position=74:5,
            source=NameRef(
                position=74:5,
                identifier='globalMetrics'
              ),
            identifier='totalErrors'
          ),
        value=IntegerLiteral(
            position=74:34,
            value=0
          )
      ),
      AssignmentStmt(
        position=75:5,
        target=AttributeRef(
            position=75:5,
            source=NameRef(
                position=75:5,
                identifier='globalMetrics'
              ),
            identifier='successfulStreams'
          ),
        value=IntegerLiteral(
            position=75:40,
            value=0
          )
      ),
      AssignmentStmt(
        position=76:5,
        target=NameRef(
            position=76:5,
            identifier='processingStartTime'
          ),
        value=Call(
            position=76:28,
            callee=NameRef(
                position=76:28,
                identifier='getCurrentTime'
              ),
            args=[]
          )
      ),
      RepeatStmt(
        position=78:5,
        control=RepeatControl(
            position=78:12,
            increment_control=IncrementControl(
                position=78:12,
                variable='streamIndex',
                bound_1=IntegerLiteral(
                    position=78:27,
                    value=1
                  ),
                bound_2=IntegerLiteral(
                    position=78:32,
                    value=5
                  )
              )
          ),
        body=[
            AssignmentStmt(
              position=79:9,
              target=AttributeRef(
                  position=79:9,
                  source=NameRef(
                      position=79:9,
                      identifier='processingContext'
                    ),
                  identifier='streamIndex'
                ),
              value=NameRef(
                  position=79:42,
                  identifier='streamIndex'
                )
            ),
            AssignmentStmt(
              position=80:9,
              target=AttributeRef(
                  position=80:9,
                  source=NameRef(
                      position=80:9,
                      identifier='processingContext'
                    ),
                  identifier='currentPhase'
                ),
              value=NameRef(
                  position=80:43,
                  identifier='preprocessing'
                )
            ),
            AssignmentStmt(
              position=81:9,
              target=AttributeRef(
                  position=81:9,
                  source=NameRef(
                      position=81:9,
                      identifier='processingContext'
                    ),
                  identifier='errorCount'
                ),
              value=IntegerLiteral(
                  position=81:41,
                  value=0
                )
            ),
            AssignmentStmt(
              position=83:9,
              target=AttributeRef(
                  position=83:9,
                  source=IndexExpr(
                      position=83:9,
                      source=NameRef(
                          position=83:9,
                          identifier='qualityReports'
                        ),
                      index=NameRef(
                          position=83:24,
                          identifier='streamIndex'
                        )
                    ),
                  identifier='streamIndex'
                ),
              value=NameRef(
                  position=83:52,
                  identifier='streamIndex'
                )
            ),
            AssignmentStmt(
              position=84:9,
              target=AttributeRef(
                  position=84:9,
                  source=IndexExpr(
                      position=84:9,
                      source=NameRef(
                          position=84:9,
                          identifier='qualityReports'
                        ),
                      index=NameRef(
                          position=84:24,
                          identifier='streamIndex'
                        )
                    ),
                  identifier='recordCount'
                ),
              value=Call(
                  position=84:52,
                  callee=NameRef(
                      position=84:52,
                      identifier='SIZEOF'
                    ),
                  args=[Arg(
                      position=84:59,
                      value=IndexExpr(
                          position=84:59,
                          source=NameRef(
                              position=84:59,
                              identifier='inputStreams'
                            ),
                          index=NameRef(
                              position=84:72,
                              identifier='streamIndex'
                            )
                        )
                    )]
                )
            ),
            AssignmentStmt(
              position=85:9,
              target=AttributeRef(
                  position=85:9,
                  source=IndexExpr(
                      position=85:9,
                      source=NameRef(
                          position=85:9,
                          identifier='qualityReports'
                        ),
                      index=NameRef(
                          position=85:24,
                          identifier='streamIndex'
                        )
                    ),
                  identifier='errorCount'
                ),
              value=IntegerLiteral(
                  position=85:51,
                  value=0
                )
            ),
            AssignmentStmt(
              position=87:9,
              target=NameRef(
                  position=87:9,
                  identifier='streamProcessingTime'
                ),
              value=Call(
                  position=87:33,
                  callee=NameRef(
                      position=87:33,
                      identifier='getCurrentTime'
                    ),
                  args=[]
                )
            ),
            RepeatStmt(
              position=89:9,
              control=RepeatControl(
                  position=89:16,
                  increment_control=IncrementControl(
                      position=89:16,
                      variable='recordIndex',
                      bound_1=IntegerLiteral(
                          position=89:31,
                          value=1
                        ),
                      bound_2=Call(
                          position=89:36,
                          callee=NameRef(
                              position=89:36,
                              identifier='SIZEOF'
                            ),
                          args=[Arg(
                              position=89:43,
                              value=IndexExpr(
                                  position=89:43,
                                  source=NameRef(
                                      position=89:43,
                                      identifier='inputStreams'
                                    ),
                                  index=NameRef(
                                      position=89:56,
                                      identifier='streamIndex'
                                    )
                                )
                            )]
                        )
                    )
                ),
              body=[
                  IfStmt(
                    position=90:13,
                    condition=UnaryExpr(
                        position=90:16,
                        op=UnaryOp.NOT,
                        operand=NameRef(
                            position=90:20,
                            identifier='shouldContinueProcessing'
                          )
                      ),
                    then=[EscapeStmt(
                        position=91:17
                      )],
                    or_else=[]
                  ),
                  AssignmentStmt(
                    position=94:13,
                    target=AttributeRef(
                        position=94:13,
                        source=NameRef(
                            position=94:13,
                            identifier='processingContext'
                          ),
                        identifier='recordIndex'
                      ),
                    value=NameRef(
                        position=94:46,
                        identifier='recordIndex'
                      )
                  ),
                  AssignmentStmt(
                    position=95:13,
                    target=NameRef(
                        position=95:13,
                        identifier='currentRecord'
                      ),
                    value=IndexExpr(
                        position=95:30,
                        source=IndexExpr(
                            position=95:30,
                            source=NameRef(
                                position=95:30,
                                identifier='inputStreams'
                              ),
                            index=NameRef(
                                position=95:43,
                                identifier='streamIndex'
                              )
                          ),
                        index=NameRef(
                            position=95:56,
                            identifier='recordIndex'
                          )
                      )
                  ),
                  AssignmentStmt(
                    position=96:13,
                    target=NameRef(
                        position=96:13,
                        identifier='isProcessingSuccessful'
                      ),
                    value=LogicalLiteral(
                        position=96:39,
                        value=TRUE
                      )
                  ),
                  AssignmentStmt(
                    position=98:13,
                    target=AttributeRef(
                        position=98:13,
                        source=NameRef(
                            position=98:13,
                            identifier='processingContext'
                          ),
                        identifier='currentPhase'
                      ),
                    value=NameRef(
                        position=98:47,
                        identifier='validation'
                      )
                  ),
                  RepeatStmt(
                    position=99:13,
                    control=RepeatControl(
                        position=99:20,
                        increment_control=IncrementControl(
                            position=99:20,
                            variable='ruleIndex',
                            bound_1=IntegerLiteral(
                                position=99:33,
                                value=1
                              ),
                            bound_2=Call(
                                position=99:38,
                                callee=NameRef(
                                    position=99:38,
                                    identifier='SIZEOF'
                                  ),
                                args=[Arg(
                                    position=99:45,
                                    value=NameRef(
                                        position=99:45,
                                        identifier='processingRules'
                                      )
                                  )]
                              )
                          )
                      ),
                    body=[
                        AssignmentStmt(
                          position=100:17,
                          target=NameRef(
                              position=100:17,
                              identifier='currentRule'
                            ),
                          value=IndexExpr(
                              position=100:32,
                              source=NameRef(
                                  position=100:32,
                                  identifier='processingRules'
                                ),
                              index=NameRef(
                                  position=100:48,
                                  identifier='ruleIndex'
                                )
                            )
                        ),
                        IfStmt(
                          position=101:17,
                          condition=UnaryExpr(
                              position=101:20,
                              op=UnaryOp.NOT,
                              operand=Call(
                                  position=101:24,
                                  callee=NameRef(
                                      position=101:24,
                                      identifier='applyProcessingRule'
                                    ),
                                  args=[
                                      Arg(
                                        position=101:44,
                                        value=NameRef(
                                            position=101:44,
                                            identifier='currentRecord'
                                          )
                                      ),
                                      Arg(
                                        position=101:59,
                                        value=NameRef(
                                            position=101:59,
                                            identifier='currentRule'
                                          )
                                      )
                                    ]
                                )
                            ),
                          then=[
                              AssignmentStmt(
                                position=102:21,
                                target=NameRef(
                                    position=102:21,
                                    identifier='isProcessingSuccessful'
                                  ),
                                value=LogicalLiteral(
                                    position=102:47,
                                    value=FALSE
                                  )
                              ),
                              AssignmentStmt(
                                position=103:21,
                                target=AttributeRef(
                                    position=103:21,
                                    source=NameRef(
                                        position=103:21,
                                        identifier='processingContext'
                                      ),
                                    identifier='errorCount'
                                  ),
                                value=BinaryExpr(
                                    position=103:53,
                                    left=AttributeRef(
                                        position=103:53,
                                        source=NameRef(
                                            position=103:53,
                                            identifier='processingContext'
                                          ),
                                        identifier='errorCount'
                                      ),
                                    op=BinaryOp.ADD,
                                    right=IntegerLiteral(
                                        position=103:84,
                                        value=1
                                      )
                                  )
                              ),
                              IfStmt(
                                position=105:21,
                                condition=BinaryExpr(
                                    position=105:24,
                                    left=NameRef(
                                        position=105:24,
                                        identifier='errorIndex'
                                      ),
                                    op=BinaryOp.LESS_THAN,
                                    right=IntegerLiteral(
                                        position=105:37,
                                        value=100
                                      )
                                  ),
                                then=[
                                    AssignmentStmt(
                                      position=106:25,
                                      target=NameRef(
                                          position=106:25,
                                          identifier='errorIndex'
                                        ),
                                      value=BinaryExpr(
                                          position=106:39,
                                          left=NameRef(
                                              position=106:39,
                                              identifier='errorIndex'
                                            ),
                                          op=BinaryOp.ADD,
                                          right=IntegerLiteral(
                                              position=106:52,
                                              value=1
                                            )
                                        )
                                    ),
                                    CallStmt(
                                      position=107:25,
                                      call=Call(
                                          position=107:25,
                                          callee=NameRef(
                                              position=107:25,
                                              identifier='logError'
                                            ),
                                          args=[
                                              Arg(
                                                position=107:34,
                                                value=NameRef(
                                                    position=107:34,
                                                    identifier='processingContext'
                                                  )
                                              ),
                                              Arg(
                                                position=107:53,
                                                value=StringLiteral(
                                                    position=107:53,
                                                    value='Processing rule failed'
                                                  )
                                              ),
                                              Arg(
                                                position=107:79,
                                                value=NameRef(
                                                    position=107:79,
                                                    identifier='errorRecord'
                                                  )
                                              )
                                            ]
                                        )
                                    ),
                                    AssignmentStmt(
                                      position=108:25,
                                      target=IndexExpr(
                                          position=108:25,
                                          source=NameRef(
                                              position=108:25,
                                              identifier='errorLogs'
                                            ),
                                          index=NameRef(
                                              position=108:35,
                                              identifier='errorIndex'
                                            )
                                        ),
                                      value=NameRef(
                                          position=108:50,
                                          identifier='errorRecord'
                                        )
                                    )
                                  ],
                                or_else=[]
                              )
                            ],
                          or_else=[]
                        )
                      ]
                  ),
                  IfStmt(
                    position=113:13,
                    condition=NameRef(
                        position=113:16,
                        identifier='isProcessingSuccessful'
                      ),
                    then=[
                        AssignmentStmt(
                          position=114:17,
                          target=AttributeRef(
                              position=114:17,
                              source=NameRef(
                                  position=114:17,
                                  identifier='processingContext'
                                ),
                              identifier='currentPhase'
                            ),
                          value=NameRef(
                              position=114:51,
                              identifier='transformation'
                            )
                        ),
                        AssignmentStmt(
                          position=115:17,
                          target=NameRef(
                              position=115:17,
                              identifier='processedRecord'
                            ),
                          value=Call(
                              position=115:36,
                              callee=NameRef(
                                  position=115:36,
                                  identifier='transformRecord'
                                ),
                              args=[Arg(
                                  position=115:52,
                                  value=NameRef(
                                      position=115:52,
                                      identifier='currentRecord'
                                    )
                                )]
                            )
                        ),
                        AssignmentStmt(
                          position=117:17,
                          target=AttributeRef(
                              position=117:17,
                              source=NameRef(
                                  position=117:17,
                                  identifier='processingContext'
                                ),
                              identifier='currentPhase'
                            ),
                          value=NameRef(
                              position=117:51,
                              identifier='postprocessing'
                            )
                        ),
                        RepeatStmt(
                          position=118:17,
                          control=RepeatControl(
                              position=118:24,
                              increment_control=IncrementControl(
                                  position=118:24,
                                  variable='thresholdIndex',
                                  bound_1=IntegerLiteral(
                                      position=118:42,
                                      value=1
                                    ),
                                  bound_2=Call(
                                      position=118:47,
                                      callee=NameRef(
                                          position=118:47,
                                          identifier='SIZEOF'
                                        ),
                                      args=[Arg(
                                          position=118:54,
                                          value=NameRef(
                                              position=118:54,
                                              identifier='qualityThresholds'
                                            )
                                        )]
                                    )
                                )
                            ),
                          body=[
                              AssignmentStmt(
                                position=119:21,
                                target=NameRef(
                                    position=119:21,
                                    identifier='currentThreshold'
                                  ),
                                value=IndexExpr(
                                    position=119:41,
                                    source=NameRef(
                                        position=119:41,
                                        identifier='qualityThresholds'
                                      ),
                                    index=NameRef(
                                        position=119:59,
                                        identifier='thresholdIndex'
                                      )
                                  )
                              ),
                              AssignmentStmt(
                                position=120:21,
                                target=NameRef(
                                    position=120:21,
                                    identifier='qualityLevel'
                                  ),
                                value=Call(
                                    position=120:37,
                                    callee=NameRef(
                                        position=120:37,
                                        identifier='evaluateQuality'
                                      ),
                                    args=[
                                        Arg(
                                          position=120:53,
                                          value=NameRef(
                                              position=120:53,
                                              identifier='processedRecord'
                                            )
                                        ),
                                        Arg(
                                          position=120:70,
                                          value=NameRef(
                                              position=120:70,
                                              identifier='currentThreshold'
                                            )
                                        )
                                      ]
                                  )
                              ),
                              IfStmt(
                                position=121:21,
                                condition=BinaryExpr(
                                    position=121:24,
                                    left=NameRef(
                                        position=121:24,
                                        identifier='qualityLevel'
                                      ),
                                    op=BinaryOp.EQUAL,
                                    right=NameRef(
                                        position=121:39,
                                        identifier='unacceptable'
                                      )
                                  ),
                                then=[
                                    AssignmentStmt(
                                      position=122:25,
                                      target=NameRef(
                                          position=122:25,
                                          identifier='isProcessingSuccessful'
                                        ),
                                      value=LogicalLiteral(
                                          position=122:51,
                                          value=FALSE
                                        )
                                    ),
                                    AssignmentStmt(
                                      position=123:25,
                                      target=AttributeRef(
                                          position=123:25,
                                          source=IndexExpr(
                                              position=123:25,
                                              source=NameRef(
                                                  position=123:25,
                                                  identifier='qualityReports'
                                                ),
                                              index=NameRef(
                                                  position=123:40,
                                                  identifier='streamIndex'
                                                )
                                            ),
                                          identifier='errorCount'
                                        ),
                                      value=BinaryExpr(
                                          position=123:67,
                                          left=AttributeRef(
                                              position=123:67,
                                              source=IndexExpr(
                                                  position=123:67,
                                                  source=NameRef(
                                                      position=123:67,
                                                      identifier='qualityReports'
                                                    ),
                                                  index=NameRef(
                                                      position=123:82,
                                                      identifier='streamIndex'
                                                    )
                                                ),
                                              identifier='errorCount'
                                            ),
                                          op=BinaryOp.ADD,
                                          right=IntegerLiteral(
                                              position=123:108,
                                              value=1
                                            )
                                        )
                                    )
                                  ],
                                or_else=[]
                              )
                            ]
                        ),
                        IfStmt(
                          position=127:17,
                          condition=NameRef(
                              position=127:20,
                              identifier='isProcessingSuccessful'
                            ),
                          then=[
                              AssignmentStmt(
                                position=128:21,
                                target=NameRef(
                                    position=128:21,
                                    identifier='bufferIndex'
                                  ),
                                value=BinaryExpr(
                                    position=128:36,
                                    left=NameRef(
                                        position=128:36,
                                        identifier='bufferIndex'
                                      ),
                                    op=BinaryOp.ADD,
                                    right=IntegerLiteral(
                                        position=128:50,
                                        value=1
                                      )
                                  )
                              ),
                              AssignmentStmt(
                                position=129:21,
                                target=IndexExpr(
                                    position=129:21,
                                    source=NameRef(
                                        position=129:21,
                                        identifier='processingBuffer'
                                      ),
                                    index=NameRef(
                                        position=129:38,
                                        identifier='bufferIndex'
                                      )
                                  ),
                                value=NameRef(
                                    position=129:54,
                                    identifier='processedRecord'
                                  )
                              ),
                              IfStmt(
                                position=131:21,
                                condition=BinaryExpr(
                                    position=131:24,
                                    left=NameRef(
                                        position=131:24,
                                        identifier='bufferIndex'
                                      ),
                                    op=BinaryOp.GREATER_EQUAL,
                                    right=NameRef(
                                        position=131:39,
                                        identifier='bufferSize'
                                      )
                                  ),
                                then=[
                                    CallStmt(
                                      position=132:25,
                                      call=Call(
                                          position=132:25,
                                          callee=NameRef(
                                              position=132:25,
                                              identifier='flushBufferToOutput'
                                            ),
                                          args=[
                                              Arg(
                                                position=132:45,
                                                value=NameRef(
                                                    position=132:45,
                                                    identifier='processingBuffer'
                                                  )
                                              ),
                                              Arg(
                                                position=132:63,
                                                value=IndexExpr(
                                                    position=132:63,
                                                    source=NameRef(
                                                        position=132:63,
                                                        identifier='outputStreams'
                                                      ),
                                                    index=NameRef(
                                                        position=132:77,
                                                        identifier='streamIndex'
                                                      )
                                                  )
                                              )
                                            ]
                                        )
                                    ),
                                    AssignmentStmt(
                                      position=133:25,
                                      target=NameRef(
                                          position=133:25,
                                          identifier='bufferIndex'
                                        ),
                                      value=IntegerLiteral(
                                          position=133:40,
                                          value=0
                                        )
                                    )
                                  ],
                                or_else=[]
                              ),
                              CallStmt(
                                position=136:21,
                                call=Call(
                                    position=136:21,
                                    callee=NameRef(
                                        position=136:21,
                                        identifier='INSERT'
                                      ),
                                    args=[
                                        Arg(
                                          position=136:28,
                                          value=IndexExpr(
                                              position=136:28,
                                              source=NameRef(
                                                  position=136:28,
                                                  identifier='outputStreams'
                                                ),
                                              index=NameRef(
                                                  position=136:42,
                                                  identifier='streamIndex'
                                                )
                                            )
                                        ),
                                        Arg(
                                          position=136:56,
                                          value=NameRef(
                                              position=136:56,
                                              identifier='processedRecord'
                                            )
                                        ),
                                        Arg(
                                          position=136:73,
                                          value=BinaryExpr(
                                              position=136:73,
                                              left=Call(
                                                  position=136:73,
                                                  callee=NameRef(
                                                      position=136:73,
                                                      identifier='SIZEOF'
                                                    ),
                                                  args=[Arg(
                                                      position=136:80,
                                                      value=IndexExpr(
                                                          position=136:80,
                                                          source=NameRef(
                                                              position=136:80,
                                                              identifier='outputStreams'
                                                            ),
                                                          index=NameRef(
                                                              position=136:94,
                                                              identifier='streamIndex'
                                                            )
                                                        )
                                                    )]
                                                ),
                                              op=BinaryOp.ADD,
                                              right=IntegerLiteral(
                                                  position=136:110,
                                                  value=1
                                                )
                                            )
                                        )
                                      ]
                                  )
                              )
                            ],
                          or_else=[]
                        )
                      ],
                    or_else=[]
                  ),
                  CallStmt(
                    position=140:13,
                    call=Call(
                        position=140:13,
                        callee=NameRef(
                            position=140:13,
                            identifier='updateMetrics'
                          ),
                        args=[
                            Arg(
                              position=140:27,
                              value=NameRef(
                                  position=140:27,
                                  identifier='processingContext'
                                )
                            ),
                            Arg(
                              position=140:46,
                              value=NameRef(
                                  position=140:46,
                                  identifier='globalMetrics'
                                )
                            )
                          ]
                      )
                  ),
                  IfStmt(
                    position=142:13,
                    condition=BinaryExpr(
                        position=142:16,
                        left=AttributeRef(
                            position=142:16,
                            source=NameRef(
                                position=142:16,
                                identifier='processingContext'
                              ),
                            identifier='errorCount'
                          ),
                        op=BinaryOp.GREATER_EQUAL,
                        right=NameRef(
                            position=142:48,
                            identifier='maxErrorsPerStream'
                          )
                      ),
                    then=[AssignmentStmt(
                        position=143:17,
                        target=NameRef(
                            position=143:17,
                            identifier='shouldContinueProcessing'
                          ),
                        value=LogicalLiteral(
                            position=143:45,
                            value=FALSE
                          )
                      )],
                    or_else=[]
                  )
                ]
            ),
            IfStmt(
              position=147:9,
              condition=BinaryExpr(
                  position=147:12,
                  left=NameRef(
                      position=147:12,
                      identifier='bufferIndex'
                    ),
                  op=BinaryOp.GREATER_THAN,
                  right=IntegerLiteral(
                      position=147:26,
                      value=0
                    )
                ),
              then=[CallStmt(
                  position=148:13,
                  call=Call(
                      position=148:13,
                      callee=NameRef(
                          position=148:13,
                          identifier='flushBufferToOutput'
                        ),
                      args=[
                          Arg(
                            position=148:33,
                            value=NameRef(
                                position=148:33,
                                identifier='processingBuffer'
                              )
                          ),
                          Arg(
                            position=148:51,
                            value=IndexExpr(
                                position=148:51,
                                source=NameRef(
                                    position=148:51,
                                    identifier='outputStreams'
                                  ),
                                index=NameRef(
                                    position=148:65,
                                    identifier='streamIndex'
                                  )
                              )
                          )
                        ]
                    )
                )],
              or_else=[]
            ),
            AssignmentStmt(
              position=151:9,
              target=NameRef(
                  position=151:9,
                  identifier='streamProcessingTime'
                ),
              value=BinaryExpr(
                  position=151:33,
                  left=Call(
                      position=151:33,
                      callee=NameRef(
                          position=151:33,
                          identifier='getCurrentTime'
                        ),
                      args=[]
                    ),
                  op=BinaryOp.SUBTRACT,
                  right=NameRef(
                      position=151:52,
                      identifier='streamProcessingTime'
                    )
                )
            ),
            AssignmentStmt(
              position=152:9,
              target=NameRef(
                  position=152:9,
                  identifier='totalProcessingTime'
                ),
              value=BinaryExpr(
                  position=152:32,
                  left=NameRef(
                      position=152:32,
                      identifier='totalProcessingTime'
                    ),
                  op=BinaryOp.ADD,
                  right=NameRef(
                      position=152:54,
                      identifier='streamProcessingTime'
                    )
                )
            ),
            AssignmentStmt(
              position=153:9,
              target=AttributeRef(
                  position=153:9,
                  source=IndexExpr(
                      position=153:9,
                      source=NameRef(
                          position=153:9,
                          identifier='qualityReports'
                        ),
                      index=NameRef(
                          position=153:24,
                          identifier='streamIndex'
                        )
                    ),
                  identifier='processingTime'
                ),
              value=NameRef(
                  position=153:55,
                  identifier='streamProcessingTime'
                )
            ),
            IfStmt(
              position=155:9,
              condition=BinaryExpr(
                  position=155:12,
                  left=AttributeRef(
                      position=155:12,
                      source=NameRef(
                          position=155:12,
                          identifier='processingContext'
                        ),
                      identifier='errorCount'
                    ),
                  op=BinaryOp.LESS_THAN,
                  right=NameRef(
                      position=155:43,
                      identifier='maxErrorsPerStream'
                    )
                ),
              then=[AssignmentStmt(
                  position=156:13,
                  target=AttributeRef(
                      position=156:13,
                      source=NameRef(
                          position=156:13,
                          identifier='globalMetrics'
                        ),
                      identifier='successfulStreams'
                    ),
                  value=BinaryExpr(
                      position=156:48,
                      left=AttributeRef(
                          position=156:48,
                          source=NameRef(
                              position=156:48,
                              identifier='globalMetrics'
                            ),
                          identifier='successfulStreams'
                        ),
                      op=BinaryOp.ADD,
                      right=IntegerLiteral(
                          position=156:82,
                          value=1
                        )
                    )
                )],
              or_else=[]
            )
          ]
      ),
      AssignmentStmt(
        position=160:5,
        target=NameRef(
            position=160:5,
            identifier='processingEndTime'
          ),
        value=Call(
            position=160:26,
            callee=NameRef(
                position=160:26,
                identifier='getCurrentTime'
              ),
            args=[]
          )
      ),
      AssignmentStmt(
        position=161:5,
        target=AttributeRef(
            position=161:5,
            source=NameRef(
                position=161:5,
                identifier='globalMetrics'
              ),
            identifier='totalProcessingTime'
          ),
        value=BinaryExpr(
            position=161:42,
            left=NameRef(
                position=161:42,
                identifier='processingEndTime'
              ),
            op=BinaryOp.SUBTRACT,
            right=NameRef(
                position=161:62,
                identifier='processingStartTime'
              )
          )
      ),
      AssignmentStmt(
        position=162:5,
        target=AttributeRef(
            position=162:5,
            source=NameRef(
                position=162:5,
                identifier='globalMetrics'
              ),
            identifier='averageStreamProcessingTime'
          ),
        value=BinaryExpr(
            position=162:50,
            left=NameRef(
                position=162:50,
                identifier='totalProcessingTime'
              ),
            op=BinaryOp.REAL_DIVIDE,
            right=RealLiteral(
                position=162:72,
                value=5.0
              )
          )
      ),
      AssignmentStmt(
        position=163:5,
        target=AttributeRef(
            position=163:5,
            source=NameRef(
                position=163:5,
                identifier='globalMetrics'
              ),
            identifier='overallSuccessRate'
          ),
        value=BinaryExpr(
            position=163:41,
            left=AttributeRef(
                position=163:41,
                source=NameRef(
                    position=163:41,
                    identifier='globalMetrics'
                  ),
                identifier='successfulStreams'
              ),
            op=BinaryOp.REAL_DIVIDE,
            right=RealLiteral(
                position=163:75,
                value=5.0
              )
          )
      )
    ]
)