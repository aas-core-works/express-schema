ProcedureDeclaration(
  position=1:1,
  identifier='complexDataProcessing',
  formal_parameters=[FormalParameter(
      position=1:37,
      identifiers=['processingState'],
      of_type=NamedType(
          position=1:55,
          reference='ProcessingState'
        )
    )],
  head=AlgorithmHead(
      declarations=[
          TypeDeclaration(
            position=2:5,
            identifier='ProcessingMode',
            type_selection=EnumType(
                position=2:27,
                values=[
                    'batch',
                    'realtime',
                    'background'
                  ]
              ),
            domain_rules=[]
          ),
          EntityDeclaration(
            position=6:5,
            identifier='ProcessingContext',
            explicit_clauses=[
                ExplicitAttributeDefinition(
                  position=7:9,
                  attributes=[NameRef(
                      position=7:9,
                      identifier='mode'
                    )],
                  optional=False,
                  type_selection=NamedType(
                      position=7:16,
                      reference='ProcessingMode'
                    )
                ),
                ExplicitAttributeDefinition(
                  position=8:9,
                  attributes=[NameRef(
                      position=8:9,
                      identifier='startTime'
                    )],
                  optional=False,
                  type_selection=RealType(
                      position=8:21
                    )
                ),
                ExplicitAttributeDefinition(
                  position=9:9,
                  attributes=[NameRef(
                      position=9:9,
                      identifier='itemsProcessed'
                    )],
                  optional=False,
                  type_selection=IntegerType(
                      position=9:26
                    )
                )
              ],
            derive_clauses=[],
            inverse_clauses=[],
            unique_rules=[],
            domain_rules=[]
          ),
          ProcedureDeclaration(
            position=12:5,
            identifier='updateProgress',
            formal_parameters=[FormalParameter(
                position=12:30,
                identifiers=['context'],
                of_type=NamedType(
                    position=12:40,
                    reference='ProcessingContext'
                  )
              )],
            head=AlgorithmHead(
                declarations=[],
                constant_definitions=[],
                local_variable_definitions=[]
              ),
            body=[AssignmentStmt(
                position=13:9,
                target=AttributeRef(
                    position=13:9,
                    source=NameRef(
                        position=13:9,
                        identifier='processingState'
                      ),
                    identifier='progress'
                  ),
                value=BinaryExpr(
                    position=13:37,
                    left=AttributeRef(
                        position=13:37,
                        source=NameRef(
                            position=13:37,
                            identifier='context'
                          ),
                        identifier='itemsProcessed'
                      ),
                    op=BinaryOp.REAL_DIVIDE,
                    right=AttributeRef(
                        position=13:62,
                        source=NameRef(
                            position=13:62,
                            identifier='processingState'
                          ),
                        identifier='totalItems'
                      )
                  )
              )]
          )
        ],
      constant_definitions=[
          ConstantDefinition(
            position=17:9,
            identifier='defaultMode',
            type_selection=NamedType(
                position=17:23,
                reference='ProcessingMode'
              ),
            init=NameRef(
                position=17:41,
                identifier='batch'
              )
          ),
          ConstantDefinition(
            position=18:9,
            identifier='maxProcessingTime',
            type_selection=RealType(
                position=18:29
              ),
            init=RealLiteral(
                position=18:37,
                value=300.0
              )
          )
        ],
      local_variable_definitions=[
          LocalVariableDefinition(
            position=22:9,
            identifiers=['context'],
            of_type=NamedType(
                position=22:19,
                reference='ProcessingContext'
              )
          ),
          LocalVariableDefinition(
            position=23:9,
            identifiers=['currentTime'],
            of_type=RealType(
                position=23:23
              )
          )
        ]
    ),
  body=[
      AssignmentStmt(
        position=26:5,
        target=AttributeRef(
            position=26:5,
            source=NameRef(
                position=26:5,
                identifier='context'
              ),
            identifier='mode'
          ),
        value=NameRef(
            position=26:21,
            identifier='defaultMode'
          )
      ),
      AssignmentStmt(
        position=27:5,
        target=AttributeRef(
            position=27:5,
            source=NameRef(
                position=27:5,
                identifier='context'
              ),
            identifier='startTime'
          ),
        value=Call(
            position=27:26,
            callee=NameRef(
                position=27:26,
                identifier='getCurrentTime'
              ),
            args=[]
          )
      ),
      AssignmentStmt(
        position=28:5,
        target=AttributeRef(
            position=28:5,
            source=NameRef(
                position=28:5,
                identifier='context'
              ),
            identifier='itemsProcessed'
          ),
        value=IntegerLiteral(
            position=28:31,
            value=0
          )
      ),
      CallStmt(
        position=30:5,
        call=Call(
            position=30:5,
            callee=NameRef(
                position=30:5,
                identifier='processItems'
              ),
            args=[
                Arg(
                  position=30:18,
                  value=NameRef(
                      position=30:18,
                      identifier='processingState'
                    )
                ),
                Arg(
                  position=30:35,
                  value=NameRef(
                      position=30:35,
                      identifier='context'
                    )
                )
              ]
          )
      ),
      CallStmt(
        position=31:5,
        call=Call(
            position=31:5,
            callee=NameRef(
                position=31:5,
                identifier='updateProgress'
              ),
            args=[Arg(
                position=31:20,
                value=NameRef(
                    position=31:20,
                    identifier='context'
                  )
              )]
          )
      ),
      AssignmentStmt(
        position=33:5,
        target=NameRef(
            position=33:5,
            identifier='currentTime'
          ),
        value=Call(
            position=33:20,
            callee=NameRef(
                position=33:20,
                identifier='getCurrentTime'
              ),
            args=[]
          )
      ),
      AssignmentStmt(
        position=34:5,
        target=AttributeRef(
            position=34:5,
            source=NameRef(
                position=34:5,
                identifier='processingState'
              ),
            identifier='processingTime'
          ),
        value=BinaryExpr(
            position=34:39,
            left=NameRef(
                position=34:39,
                identifier='currentTime'
              ),
            op=BinaryOp.SUBTRACT,
            right=AttributeRef(
                position=34:53,
                source=NameRef(
                    position=34:53,
                    identifier='context'
                  ),
                identifier='startTime'
              )
          )
      )
    ]
)